# OSI 7계층



## OSI 7계층이란?

OSI 7 계층은 네트워크 통신을 구성하는 요소들을 7개의 계층으로 표준화한 것이다.

![img](https://blog.kakaocdn.net/dn/bqbCLk/btryyf3MHwI/E20STGOkRn5Y1Lkc88oDP1/img.png)

| 계층                         | **설명**                                                     |
| ---------------------------- | ------------------------------------------------------------ |
| **7계층 (응용 계층)**        | - 사용자와 직접 상호작용하는 응용 프로그램들이 포함된 계층<br />- HTTP, FTP, SMTP, Telnet 등과 같은 프로토콜이 대표적이다. |
| 6계층 (표현 계층)            | -  데이터의 형식을 정의하는 계층 (데이터 변환, 압축, 암호화 등) |
| 5계층(세션 계층)             | - 통신 시스템 사용자 간의 연결을 유지 및 설정하는 계층 (API, Socket)<br />- 세션 설정, 유지, 종료, 전송 중단 시 복구 제공<br />- **전이중 통신과 반이중 통신** 방식이 존재한다. |
| **4계층 (전송 계층)**        | - 종단 간 신뢰성 있고 정확한 데이터 전송을 담당하는 계층<br />- 송신자와 수신자 간의 신뢰성있고 효율적인 데이터를 전송하기 위하여 오류검출 및 복구, 흐름제어와 중복검사 등을 수행한다. <br />- 데이터 전송을 위해 **포트 번호를 **사용하며 대표적인 프로토콜은 **TCP와 UDP**가 있다. |
| **3계층 (네트워크 계층)**    | - IP를 기반으로 데이터(**패킷**) 전송 경로를 결정하는 계층(라우팅) <br />- 라우팅, 흐름제어, 세그멘테이션, 오류 제어 등을 수행한다. |
| **2계층 (데이터 링크 계층)** | - **MAC 주소**를 사용하여 통신한다. <br />- 데이터의 물리적인 전송과 에러 검출, 흐름 제어를 담당하는 계층 (브리지, 스위치 ) |
| 1계층 (물리 계층)            | - 데이터를 전기 신호로 바꾸어주는 계층 (통신 케이블, 리피터, 허브) |

<br/>

## Q. OSI 7계층을 나눈 이유는?

통신이 일어나는 과정을 단계별로 파악할 수 있어, 문제가 발생하면 해당 문제를 해결하기 용이해집니다.

7단계 중 특정한 곳에 이상이 생기면 다른 단계의 장비 및 소프트웨어를 건들이지 않고도 이상이 생긴 단계만 고칠 수 있기 때문입니다. 


<br/>


## TCP/IP 4계층

TCP/IP 프로토콜 통신 과정에 초점을 맞추어, OSI 7계층을 좀 더 단순화 시킨 계층을 의미한다. 



![img](https://velog.velcdn.com/images%2Fcgotjh%2Fpost%2F52907c8c-c149-4943-ad21-3996f44f912f%2F995EFF355B74179035.jpg)

| 계층                             | **설명**                                                     |
| -------------------------------- | ------------------------------------------------------------ |
| 4계층 (응용 계층)                | - 사용자와 가장 가까운 계층으로, 사용자-소프트웨어 간 소통을 담당하는 계층<br />- 대표적인 프로토콜 : HTTP, FTP, DNS 등<br /> |
| **3계층 (전송 계층)**            | - 통신 노드 간 신뢰성 있는 데이터 전송을 보장하는 계층<br />- **IP와 포트번호**를 이용하여 프로세스와 통신<br />- 대표적인 프로토콜 : TCP, UDP<br />- 데이터 단위 : 데이터 그램 |
| **2계층 (인터넷 계층)**          | - 통신 노드 간의 **IP 패킷 전송** 및 **라우팅**을 담당하여 서로 다른 네트워크 간의 통신을 가능하게 한다. <br />- 대표적인 프로토콜 : IP, ARP, RARP<br />- 데이터 단위는 **패킷** |
| 1계층 (네트워크 인터페이스 계층) | - MAC주소를 활용하여 물리적으로 장비간 데이터 전송을 담당하는 계층 (이더넷, 와이파이 등)<br />- 데이터 단위는 **프레임** |


<br/>


## Q. OSI 7계층에서 Transport Layer와, Network Layer의 차이에 대해 설명해 주세요.

네트워크 계층은 호스트 간의 논리적 통신을 돕지만, 전송계층은 응용 프로세스 간의 논리적인 통신을 돕습니다. 

**네트워크 계층**은 라우터를 통해 패킷을 목적지까지 안전하고 빠르게 전달하고, 

**전송 계층**은 목적지 프로세스에 도달하기 위해 포트번호를 활용하며 데이터를 신뢰성있게 주고 받을 수 있도록 합니다. 

<br/>

## Q. L3 Switch와 Router의 차이에 대해 설명해 주세요.

일반적으로 스위치는 2계층 장비를 뜻하기 때문에 L2스위치도 함께 설명

- **L2스위치**

**MAC 주소**를 기반으로 디바이스 위치를 파악하고 통신할 수 있습니다. (MAC 주소 테이블을 사용하여 저장)

ARP등을 통해 **불명확한 목적지를 가진 데이터를 처리**할 때 모든 포트로 데이터를 퍼뜨리는 **브로드 캐스트**를 합니다. 



- **L3스위치**

L2스위치의 기능보다 업그레이드 되어 IP주소를 활용한 라우팅이 가능합니다. 



- **라우터**

L3계층에 속하는 장치이며, IP주소를 기반으로 디바이스 위치를 파악하고 통신합니다. 

라우터는 브로드캐스트 도메인을 구분하여 서로 다른 네트워크 대역을 구분할 수 있습니다. 



**=> L3스위치와 라우터는 기능적으로 같은 역할을 합니다. 과거에는 라우터는 소프트웨어로 구현하고 스위치는 하드웨어로 구현하는 형태로 구분했으나 최근에는 구분이 어렵다.** 


<br/>


## Q.각 Layer는 패킷을 어떻게 명칭하나요? 예를 들어, Transport Layer의 경우 Segment라 부릅니다. 각각의 Header의 Packing Order에 대해 설명해 주세요.

응용계층에서 시작하여 맨 하위 계층인 물리 계층까지 내려가는데 계층을 내려갈 때마다 데이터 앞에 계층 정보(기능과 관련된 정보)를 포함하는 헤더(header)를 붙이게 되는데 이 과정을 **encapsulation**이라고 합니다. 

반대로 송신할 때는 1계층에서 5계층으로 올라가며 **역캡슐화(decapsulation)**를 통해 최초에 보냈던 데이터만을 추출해낼 수 있습니다. 

### **각 계층의 패킷 명칭**,헤더

서버 **애플리케이션**은 만든 **데이터/메세지**를 전송 계층에 전달하고 

**전송계층**은 받은 애플리케이션 데이터를 TCP/UDP **세그먼트**에 넣어 네트워크 계층에 전달
(TCP 프로토콜의 경우 헤더에 출발지, 목적지 포트번호와 순서보장을 위한 일련번호 신뢰성을 위한 헤더 정보들이 추가됩니다. UDP의 경우는 포트번호만 추가)

**네트워크 계층**은 받은 세그먼트를 IP**패킷**에 추가하여 데이터 링크 계층으로 전달  
(주요 헤더로는 오류 확인을 위한 **체크섬**이 있습니다. )

**데이터 링크 계층**은 이더넷 **프레임**에 넣어 물리계층으로 전달
(출발지와 목적지의 MAC주소가 헤더에 포함되어있습니다. )

**물리계층**은 받은 프레임을 **비트**로 변환 후 전기신호나 광신호로 만들어 보냄


<br/>


## Q. ARP에 대해 설명해주세요

=>**ARP(주소 결정 프로토콜)**는 네트워크 상에서 IP 주소를 물리적 네트워크 주소(MAC 주소)로 대응시키기 위해 사용되는 프로토콜입니다.

IP주소와 MAC 주소를 일대일 대응하여 정리한 테이블을 **ARP Table**이라고 합니다.



### **ARP 동작원리**

| ![ARP query 브로드캐스팅](https://blog.kakaocdn.net/dn/bFifqn/btrvocYEahT/fS2g5gOEKHXfxnYKAi0oK0/img.webp) | ![ARP Request](https://blog.kakaocdn.net/dn/cZPoiU/btrvyk1H4Ym/TPqhXhvX08nh8SvDFkHwvk/img.webp) |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

송신자는 목적지 IP 주소는 알지만 MAC주소를 모르는 상황에서

1. 송신자는 목적지 IP 주소를 지정해 패킷을 송신한다. 
2. IP프로토콜이 ARP 프로토콜에게 ARP Request 메세지를 생성하도록 요청한다. 
   (ARP 요청 메세지 - 송신자 물리주소, 송신자 IP주소, 00-00-00-00-00, 수신자 IP주소)
3. 메세지는 2계층으로 전달이 되고 **브로드캐스트**로 진행
4. **목적지 IP주소가 일치하는 시스템은 자신의 물리주소를 포함해서 ARP Reply를 보낸다.** 
5. 최초 송신자는 지정한 IP 주소에 대응하는 MAC주소를 획득한다. 
   (ARP 요청은 브로드캐스트, ARP 응답은 유니캐스트)

<br/>

## Q. MAC 주소와 IP주소를 분리하는 이유

=> IP주소와 MAC주소는 사용하는 계층이 다릅니다. **IP 주소는 논리적 주소이며 MAC 주소는 물리적 주소입니다.** **두 계층의 주소를 독립해서 프로토콜에 구애 받지 않을 수 있습니다. **



### **IP주소로만 통신을 한다면?**

IP주소는 모든 네트워크 레이어의 식별 값이 아닙니다. 실질적으로 데이터가 목적지 호스팅에 도달하기 위해서는 MAC주소가 필요합니다. 



### MAC주소로만 통신을 한다면?

예를 들어 집에서 naver.com의 웹서버를 찾는다고 가정하면, ISP 내의 모든 라우터들은 모든 서버들의 MAC주소를 다 가지고 있어야 한다. 즉, 하나하나 MAC주소에 대해 라우팅을 해주어야 한다. 하지만 IP주소체계는 변경이 가능하고 라우팅하는데 효과적이다. 

<br/>

## Q. 소켓에 대해 설명해주세요

네트워크를 경유하는 프로세스 간 통신의 종착점. OSI 7계층 중 응용 계층에 속하는 프로세스들은 데이터 송수신을 위해 반드시 소켓을 거쳐 전송 계층으로 데이터를 전달해야합니다. 

**소켓은 전송 계층과 응용 프로그램 사이의 인터페이스 역할을 하며 떨어져 있는 두 호스트를 연결해줍니다.**

<br/>

## Q. 흐름제어가 필요한 이유에 대해 설명해주세요

**흐름제어는 송신 측과 수신 측의 데이터 처리 속도차이를 해결하기 위한 기법**으로서, 수신측이 송신측 보다 처리 속도가 빠르다면 문제가 될 것이 없지만,
 만약 송신측이 수신측보다 전송속도가 빠르다면 전송된 패킷은 수신측의 제한된 저장 용량을 초과하여 이후에 도착하는 데이터가 손실될 수 있기 때문에 필요한 기법입니다.

대표적으로는 Stop and Wait 방식과 SlidingWindow 방식이 있습니다. 



### 혼잡제어?

송신자의 전송 속도와 네트워크의 처리속도 차이로 인한 문제를 해결하기 위한 기능입니다.

대표적으로는 AIMD 방식이 존재합니다. 



두 기능의 공통점은 송신자의 전송 속도를 제어함으로써 데이터 전송 시 오류를 줄이는 기능이라는 것입니다.

두 기능의 차이점은 흐름 제어는 송수신 측 사이의 패킷 수를 제어하는 기능이고, 혼잡제어는 네트워크 내의 패킷 수를 조절하는 기능이라는 것입니다.

<br/>

<details>

<summary>[참조]</summary>

- OSI 7계층 , TCP IP 계층 관련

  https://shlee0882.tistory.com/110#google_vignette

  https://lxxyeon.tistory.com/155

  https://velog.io/@cgotjh/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-OSI-7-%EA%B3%84%EC%B8%B5-OSI-7-LAYER-%EA%B8%B0%EB%B3%B8-%EA%B0%9C%EB%85%90-%EA%B0%81-%EA%B3%84%EC%B8%B5-%EC%84%A4%EB%AA%85

- 스위치와 라우터

  https://code-lab1.tistory.com/292#google_vignette

  https://catsbi.oopy.io/225439bd-ec84-4e16-aeca-0dfcb9954ea6 (심화 내용)

- IP주소, MAC 주소

  https://www.blog.ecsimsw.com/entry/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-MAC-%EC%A3%BC%EC%86%8C%EA%B0%80-%EC%9E%88%EB%8A%94%EB%8D%B0-IP-%EC%A3%BC%EC%86%8C%EA%B0%80-%EC%99%9C-%ED%95%84%EC%9A%94%ED%95%B4

- 각 계층 헤더 구조

  https://ergate.tistory.com/entry/3%EA%B3%84%EC%B8%B5-IP-Herder (3계층)

  https://ergate.tistory.com/entry/4%EA%B3%84%EC%B8%B5-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC%EA%B3%84%EC%B8%B5 (4계층)

- 소켓

  https://velog.io/@newdana01/%EC%86%8C%EC%BC%93%EC%9D%B4%EB%9E%80-%EC%A2%85%EB%A5%98-%ED%86%B5%EC%8B%A0-%ED%9D%90%EB%A6%84-HTTP%ED%86%B5%EC%8B%A0%EA%B3%BC%EC%9D%98-%EC%B0%A8%EC%9D%B4

- 흐름제어와 혼잡제어

  https://80000coding.oopy.io/f5fe190f-bbad-4956-8789-36546f42be83

  </details>
